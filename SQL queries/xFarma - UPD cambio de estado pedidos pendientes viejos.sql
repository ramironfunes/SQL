select alm_mpt_cab.alm_mptcab_pk, alm_mpt_lin.alm_mptlin_pk, alm_mpt_lin.mptl_cant_pen, cast(alm_mpt_cab.mpt_fechamov as date) as FECHA, cast(alm_mpt_cab.mpt_hora_sum as time) as HORA,
alm_mpt_cab.alm_mptcab_pk as NRO_OP, '          ', 'P' as TIPO_OP,
alm_almacenes3.almacen_deno as ORIGEN, --JVADELL 19/04/2022
alm_und_consumos.uc_deno as DESTINO,
alm_articulos_mc.cod_bar_mc_pr as COD_ART, alm_articulos_mc.art_mc_nom as ARTICULO,
alm_mpt_lin.mptl_cant_ori as CANTIDAD_SOLICITADA, alm_mpt_lin.mptl_cant_ent as CANTIDAD_ENTREGADA,
alm_mpt_lin.mptl_cant_pen as CANTIDAD_PENDIENTE, alm_arti_alma.almaart_existen as STOCK,
alm_mpt_lin.*
from alm_mpt_cab
inner join alm_mpt_lin on alm_mpt_lin.alm_mptcab_pk = alm_mpt_cab.alm_mptcab_pk
inner join alm_articulos_mc on alm_articulos_mc.cod_art_mc_pk = alm_mpt_lin.mptl_art_pk
inner join alm_arti_alma on alm_arti_alma.cod_art_mc_pk = alm_mpt_lin.mptl_art_pk
inner join alm_und_consumos on alm_und_consumos.uc_pk = alm_mpt_cab.mpt_almout_pk
inner join alm_almacenes alm_almacenes3 on alm_almacenes3.almacen_pk = alm_mpt_cab.mpt_almin_pk --JVADELL 19/04/2022
where alm_arti_alma.almacen_pk = 4
and alm_mpt_lin.mptl_cant_pen > 0
--and alm_mpt_lin.mptl_cant_pen > alm_arti_alma.almaart_existen
and  ( alm_articulos_mc.catp_tipopro_pk = 2 OR alm_articulos_mc.cod_bar_mc_pr IN ('FDN042', 'FDN011', 'FDN016', 'FDN004', 'FDN023', 'FDN022', 'FDN003', 'FDN002', 'FDN041', 'FDN009', 'FDN019', 'FDN005', 'FDN012', 'FDN021', 'FDN033', 'FDN034', 'FDN001', 'FDN018', 'FDN035') )
order by 1,2



BEGIN TRAN
update alm_mpt_lin set mptl_cant_pen = '0.000' where alm_mptlin_pk in 
('37364106',
'37365737',
'38106512',
'38106737',
'38106739',
'38106761',
'38106767',
'38106768',
'38106769',
'38106774',
'38106808',
'38106857',
'38106882',
'38106934',
'38108083',
'38108085',
'38108096',
'38108097',
'38108112',
'38108168',
'38108171',
'38108218',
'38108219',
'38108220',
'38108223',
'38117546',
'38117549',
'38117550',
'38117595',
'38117597',
'38117602',
'38583555',
'38583567',
'39845151',
'39845156',
'41048318',
'41048495',
'41048536',
'41048537',
'43870896',
'43870899',
'43870902',
'43870913',
'43870917',
'43870920',
'43870923',
'43870926',
'43870928',
'43870932',
'43870935',
'43870937',
'43870939',
'43870945',
'43870965',
'43870966',
'43870968',
'43870971',
'43870974',
'43870977',
'43870986',
'43870988',
'43870991',
'43871029',
'43871032',
'43871033',
'43871069',
'43871071',
'43871073',
'43871075',
'43871078',
'43871098',
'43871099',
'43871101',
'43871103',
'43871121',
'43871124',
'43871131',
'43871144',
'43871167',
'43871169',
'43871175',
'43871194',
'43871198',
'43871201',
'43871235',
'43871243',
'43871245',
'43871250',
'43871252',
'43871254',
'44555995',
'44556088',
'44556089',
'44556097',
'44557194',
'44557196',
'44557367',
'44557370',
'44557390',
'44557391',
'44557357',
'44557358',
'44557427',
'44602608',
'44602626',
'44602640',
'44602662',
'44602693',
'44602695',
'44602748',
'44603465',
'44603499',
'44603535',
'44603683',
'44603746',
'44603786',
'44603839',
'44603967',
'44604043',
'44604105',
'44617852',
'44617860',
'44630886',
'44630888',
'44631595',
'44631596',
'44631653',
'44631656',
'44632038',
'44693025',
'44693057',
'44693060',
'44696381',
'44696382',
'44696383',
'44700510',
'44700599',
'44700766',
'44700964',
'44701033',
'44701111',
'44842072',
'44842124',
'44842139',
'44842140',
'44842143',
'44842146',
'44842407',
'44842412',
'44842583',
'44842584',
'44842585',
'44842604',
'44842636',
'44842637',
'45924075',
'46374853',
'47137328',
'47137352',
'47137373',
'47137412',
'47140473',
'47140479',
'47140480',
'47140482',
'47140523',
'47140536',
'47140537',
'47140547',
'47140584',
'47140585',
'47140586',
'47140588',
'47140591',
'47140593',
'47140599',
'47140648',
'47140669',
'47140670',
'47140758',
'47140759',
'47140760',
'47140781',
'47140782',
'47140783',
'47140784',
'47140785',
'47140787',
'47140788',
'47140791',
'47140793',
'47140814',
'47140816',
'47140818',
'47140819',
'47140820',
'47140822',
'47140829',
'47140837',
'47140841',
'47140842',
'47140845',
'47140846',
'47140853',
'47140861',
'47140862',
'47149766',
'47372364',
'47372368',
'47515503',
'47515621',
'47515662',
'47517212')
COMMIT TRAN   